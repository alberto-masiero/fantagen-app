<div class="pitch-wrapper">

<div class="pitch pitch-3d">
  <!-- SOLO overlay (bordo + vignetta). Non metterci dentro porte/linee -->
  <div class="markings"></div>

  <!-- LINEE -->
  <div class="halfway"></div>
  <div class="center-circle"></div>
  <div class="center-spot"></div>

  <!-- AREE -->
  <div class="penalty-area top"></div>
  <div class="penalty-area bottom"></div>

  <div class="goal-area top"></div>
  <div class="goal-area bottom"></div>

  <!-- DISCHETTO + ARCO -->
  <div class="penalty-spot top"></div>
  <div class="penalty-spot bottom"></div>

  <div class="penalty-arc top"></div>
  <div class="penalty-arc bottom"></div>

  <!-- PORTE (fuori da .markings, cosÃ¬ non vengono coperte dall'overlay) -->
  <div class="goal top"></div>
  <div class="goal bottom"></div>

  <!-- ANGOLI -->
  <div class="corner tl"></div>
  <div class="corner tr"></div>
  <div class="corner bl"></div>
  <div class="corner br"></div>

  <!-- PLAYERS -->
  <ng-container *ngFor="let s of spots(); let i = index">
    <div class="spot" [style.top.%]="s.top" [style.left.%]="s.left">
      <div class="slot" [attr.data-slot]="i">
 <div class="player" *ngIf="playerAt(i) as p">
  <div class="badge-card compact">

    <!-- RIGA 1: logo + nome + trend -->
    <div class="row row1">
      <div class="logo-mini">
        <img *ngIf="p.teamLogo; else teamText"
             [src]="p.teamLogo"
             [alt]="p.team ?? 'team'">
        <ng-template #teamText>
          <span>{{ (p.team ?? '?') | slice:0:3 }}</span>
        </ng-template>
      </div>

      <div class="name-inline">{{ p.name }}</div>

      <div class="trend-inline" [attr.data-trend]="p.trend ?? '='">
        {{ trendArrow(p.trend) }}
      </div>
    </div>

    <!-- RIGA 2: MV -->
    <div class="row row2">
      <span class="mv-pill">MV {{ p.rating }}</span>
    </div>

    <!-- RIGA 3: Tit (bar o flag) -->
    <div class="row row3" *ngIf="titType(p) !== 'none'">
      <ng-container *ngIf="titType(p) === 'num'; else flagTpl">
        <div class="tit-row">
          <span class="tit-label">Tit</span>
          <span class="tit-val">{{ titPercent(p) }}%</span>
        </div>
        <div class="tit-bar">
          <div
            class="tit-fill"
            [class.low]="titPercent(p) < 35"
            [class.mid]="titPercent(p) >= 35 && titPercent(p) < 70"
            [class.high]="titPercent(p) >= 70"
            [style.width]="titPercent(p) + '%'"
          ></div>
        </div>
      </ng-container>

      <ng-template #flagTpl>
        <div class="flag" [attr.data-flag]="titFlagVal(p)">
          {{ titFlagVal(p) === 'I' ? 'INJ' : 'SUS' }}
        </div>
      </ng-template>
    </div>

  </div>
</div>



        <div class="player ghost" *ngIf="!playerAt(i)">
          <div class="jersey">
            <div class="collar"></div>
            <div class="num">+</div>
          </div>
          <div class="label">
            <div class="pname">slot</div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>
</div>
